---
- name: Install Emacs
  community.general.snap:
    name: emacs
    channel: stable
    classic: true
    state: present
  become: true

- name: Copy Emacs snap app launcher to ~/.local/share/applications/
  ansible.builtin.copy:
    src: /var/lib/snapd/desktop/applications/emacs_emacs.desktop
    dest: /home/cenouro/.local/share/applications/emacs_emacs.desktop
    mode: preserve
    force: false

- name: Customize Emacs app launcher
  ansible.builtin.lineinfile:
    path: /home/cenouro/.local/share/applications/emacs_emacs.desktop
    regexp: '{{ item.regexp }}'
    line: '{{ item.line }}'
  loop:
    - regexp: '^Exec=env BAMF_DESKTOP_FILE_HINT=/var/lib/snapd/desktop/applications/emacs_emacs.desktop /snap/bin/emacs %F'
      line: 'Exec=env BAMF_DESKTOP_FILE_HINT=/var/lib/snapd/desktop/applications/emacs_emacs.desktop /snap/bin/emacs --maximized %F'
    - regexp: '^Icon=/snap/emacs/'
      line: 'Icon=/snap/emacs/current/usr/share/icons/hicolor/scalable/apps/emacs.svg'
...
